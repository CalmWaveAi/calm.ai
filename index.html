<!DOCTYPE html>
<html>
<head>
  <title>Lets take a break</title>
  <meta name="description" content="AI-generated calming sound to reduce stress and anxiety">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: Sondra, sans-serif;
      background: #fffff0;
      text-align: center;
      padding: 30px;
    }
    textarea {
      width: 55%;
      height: 120px;
      font-size: 16px;
      padding: 10px;
    }
    button {
      margin-top: 15px;
      padding: 15px 25px;
      font-size: 24px;
      border: none;
      border-radius: 8px;
      background: #fff8dc;
      color: black;
      cursor: pointer;
    }
    button:hover {
      background: #45a8a8;
    }
    p {
      margin-top: 20px;
      font-size: 16px;
    }
  </style>
</head>

<!-- PayPal Buy Now Button -->
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
  <input type="hidden" name="cmd" value="_xclick">
  <input type="hidden" name="business" value="YOUR_PAYPAL_ACCOUNT">
  <input type="hidden" name="item_name" value="Calm AI Premium">
  <input type="hidden" name="amount" value="5.00">
  <input type="hidden" name="currency_code" value="USD">
  <input type="submit" value="Unlock Premium Calm AI" style="padding:15px 25px; font-size:18px; border:none; border-radius:8px; background:#fff8dc; color:black; cursor:pointer;">
</form>

<body>
<h1>Lets take a break</h1>
<p>Express yourself, let it all out.</p>

<textarea id="feelings" placeholder="I feel anxious, stressed, overwhelmed..."></textarea>
<br>
<button onclick="startCalm()">Calm Me Down</button>
<button onclick="stopCalm()">Stop</button>

<p id="status"></p>

<script>
let audioCtx;
let masterGain;
let sources = [];
let isPlaying = false;

function startCalm() {
  if (isPlaying) return;
  const text = document.getElementById("feelings").value.toLowerCase();
  const status = document.getElementById("status");
  status.innerText = "Nature AI is creating a calm space for you üåø";

  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  masterGain = audioCtx.createGain();
  masterGain.gain.value = 0.08;
  masterGain.connect(audioCtx.destination);

  // üåä WIND / OCEAN (low frequency movement)
  const windOsc = audioCtx.createOscillator();
  windOsc.type = "sine";
  windOsc.frequency.value = 0.08; // very slow
  const windGain = audioCtx.createGain();
  windGain.gain.value = 0.5;
  windOsc.connect(windGain).connect(masterGain);
  windOsc.start();
  sources.push(windOsc);

  // üåßÔ∏è RAIN / LEAVES (pink-ish noise)
  const bufferSize = 2 * audioCtx.sampleRate;
  const noiseBuffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
  const output = noiseBuffer.getChannelData(0);
  let last = 0;
  for (let i = 0; i < bufferSize; i++) {
    const rnd = Math.random() * 2 - 1;
    output[i] = (last + 0.02 * rnd) / 1.02;
    last = output[i];
  }
  const rain = audioCtx.createBufferSource();
  rain.buffer = noiseBuffer;
  rain.loop = true;
  const rainGain = audioCtx.createGain();
  rainGain.gain.value = 0.15;
  rain.connect(rainGain).connect(masterGain);
  rain.start();
  sources.push(rain);

  // üå≤ BREATHING MOTION (slow volume waves)
  const lfo = audioCtx.createOscillator();
  lfo.type = "sine";
  lfo.frequency.value = 0.04;
  const lfoGain = audioCtx.createGain();
  lfoGain.gain.value = 0.03;
  lfo.connect(lfoGain).connect(masterGain.gain);
  lfo.start();
  sources.push(lfo);

  // Mood adjustments
  if (text.includes("anxious") || text.includes("panic")) {
    masterGain.gain.value = 0.06;
    lfo.frequency.value = 0.03;
  }
  if (text.includes("sleep") || text.includes("tired")) {
    masterGain.gain.value = 0.05;
    lfo.frequency.value = 0.02;
  }

  isPlaying = true;

  setTimeout(stopCalm, 10800000); // 3 hours
}

function stopCalm() {
  sources.forEach(src => { try { src.stop(); } catch(e) {} });
  sources = [];
  if (audioCtx) audioCtx.close();
  isPlaying = false;
  document.getElementById("status").innerText = "Session ended üåô";
}
</script>

    // Stop after 1 hour automatically
    setTimeout(stopCalm, 3600000);
    isPlaying = true;

  } catch (e) {
    status.innerText = "Sorry, your browser does not support audio generation.";
    console.error(e);
  }
}

function stopCalm() {
  const status = document.getElementById("status");
  if (oscillators.length > 0) {
    oscillators.forEach(o => {
      try { o.stop(); } catch(e){}
    });
    oscillators = [];
  }
  if (audioCtx) {
    try { audioCtx.close(); } catch(e){}
  }
  status.innerText = "Session stopped üåô You did great!";
  isPlaying = false;
}
</script>

</body>
</html>

