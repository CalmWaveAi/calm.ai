<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nature Calm AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin: 0;
  height: 100vh;
  background: linear-gradient(to bottom, #eaf7f1, #cde6db);
  font-family: system-ui, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
}

.container {
  width: 90%;
  max-width: 420px;
  text-align: center;
}

.bubble {
  width: 120px;
  height: 120px;
  margin: 0 auto 25px;
  background: rgba(255,255,255,0.7);
  border-radius: 50%;
  animation: float 8s ease-in-out infinite;
  box-shadow:
    inset -10px -10px 25px rgba(255,255,255,0.9),
    inset 10px 10px 25px rgba(160,200,180,0.5),
    0 20px 40px rgba(0,0,0,0.08);
}

@keyframes float {
  0% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-12px) scale(1.05); }
  100% { transform: translateY(0) scale(1); }
}

textarea {
  width: 100%;
  height: 120px;
  border-radius: 30px;
  border: none;
  padding: 20px;
  font-size: 16px;
  outline: none;
  resize: none;
  box-shadow: 0 15px 30px rgba(0,0,0,0.1);
}

button {
  width: 100%;
  margin-top: 20px;
  padding: 16px;
  border-radius: 30px;
  border: none;
  font-size: 18px;
  background: #7fcdbb;
  color: white;
  cursor: pointer;
}

button:hover {
  background: #69b6a5;
}

.status {
  margin-top: 15px;
  font-size: 14px;
  color: #355;
}
</style>
</head>

<body>

<div class="container">
  <div class="bubble"></div>

  <textarea placeholder="Let your thoughts rest hereâ€¦"></textarea>

  <button onclick="startCalm()">Begin Nature Calm</button>

  <div class="status" id="status"></div>
</div>

<script>
let ctx;
let active = false;
let nodes = [];

function startCalm() {
  if (active) return;
  active = true;

  document.getElementById("status").innerText =
    "Generating natural calm soundsâ€¦";

  ctx = new (window.AudioContext || window.webkitAudioContext)();

  createWind();
  createLeaves();
  createBirds();
  createGentleVoice();

  // Auto stop after 3 hours
  setTimeout(stopCalm, 10800000);
}

/* ðŸŒ¬ WIND */
function createWind() {
  const buffer = ctx.createBuffer(1, ctx.sampleRate * 2, ctx.sampleRate);
  const data = buffer.getChannelData(0);
  let last = 0;

  for (let i = 0; i < data.length; i++) {
    const noise = Math.random() * 2 - 1;
    data[i] = (last + 0.03 * noise) / 1.03;
    last = data[i];
  }

  const src = ctx.createBufferSource();
  src.buffer = buffer;
  src.loop = true;

  const filter = ctx.createBiquadFilter();
  filter.type = "lowpass";
  filter.frequency.value = 700;

  const gain = ctx.createGain();
  gain.gain.value = 0.18;

  src.connect(filter).connect(gain).connect(ctx.destination);
  src.start();

  nodes.push(src);
}

/* ðŸƒ LEAF RUSTLE */
function createLeaves() {
  const osc = ctx.createOscillator();
  osc.type = "triangle";
  osc.frequency.value = 200;

  const gain = ctx.createGain();
  gain.gain.value = 0.02;

  const lfo = ctx.createOscillator();
  lfo.frequency.value = 0.15;

  const lfoGain = ctx.createGain();
  lfoGain.gain.value = 80;

  lfo.connect(lfoGain).connect(osc.frequency);

  osc.connect(gain).connect(ctx.destination);
  osc.start();
  lfo.start();

  nodes.push(osc, lfo);
}

/* ðŸ¦ BIRDS (VERY SUBTLE) */
function createBirds() {
  setInterval(() => {
    const osc = ctx.createOscillator();
    osc.type = "sine";
    osc.frequency.value = 1800 + Math.random() * 600;

    const gain = ctx.createGain();
    gain.gain.value = 0.015;

    osc.connect(gain).connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.4);
  }, 12000);
}

/* ðŸŽ¤ GENTLE VOCAL AI (NO WORDS) */
function createGentleVoice() {
  const osc = ctx.createOscillator();
  osc.type = "sawtooth";
  osc.frequency.value = 130;

  const formantA = ctx.createBiquadFilter();
  formantA.type = "bandpass";
  formantA.frequency.value = 650;
  formantA.Q.value = 6;

  const formantB = ctx.createBiquadFilter();
  formantB.type = "bandpass";
  formantB.frequency.value = 1100;
  formantB.Q.value = 8;

  const gain = ctx.createGain();
  gain.gain.value = 0.035;

  const breath = ctx.createOscillator();
  breath.frequency.value = 0.025;

  const breathGain = ctx.createGain();
  breathGain.gain.value = 0.02;

  breath.connect(breathGain).connect(gain.gain);

  osc.connect(formantA)
     .connect(formantB)
     .connect(gain)
     .connect(ctx.destination);

  osc.start();
  breath.start();

  nodes.push(osc, breath);
}

function stopCalm() {
  nodes.forEach(n => { try { n.stop(); } catch(e){} });
  nodes = [];
  ctx.close();
  active = false;
  document.getElementById("status").innerText = "Session ended ðŸŒ™";
}
</script>

</body>
</html>
